<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>对象循环引用检验</title>
</head>

<body>
  <script>
    function existCircular(obj) {
      let cache = new Set();
      function helper(obj) {
        let values = Object.values(obj);
        console.log(7,values);
        console.log(8,cache);
        for (let i = 0; i < values.length; i++) {
          if (cache.has(values[i])) {
            return true;
          }

          // 不是引用数据类型，直接跳过
          if (typeof values[i] !== 'object' || values[i] === null) continue
          cache.add(values[i]);

          let flag = helper(values[i]);
          // 如果 flag 是 false, 那么继续遍历，如果是 true,说明已经存在环了， 直接 return true
          if (flag) {
            return true;
          }
        }
        return false;
      }

      return helper(obj);
    }

    // 测试
    const person = { name: 'kalory', age: 18, work: "it" }
    person.onwer = person
    console.log( existCircular(person));  // true
    const person2 = { name: 'kalory', age: 18 }
   
    console.log( existCircular(person2));  // 


  </script>
</body>

</html>